# Feature Specification: 出欠確認プロトタイプ

**Feature Branch**: `001-attendance-prototype`
**Created**: 2025-11-05
**Status**: Draft
**Input**: User description: "プロトタイプの出欠確認アプリ。認証なし、ローカルストレージでデータ管理。全員が管理者でグループ作成可能。ユーザーはグループを選び名前を入力して出欠（◯/△/✗）を登録。グループごとの集計表示、出欠履歴表示、登録の編集・削除機能を含む。"

## User Scenarios & Testing *(mandatory)*

### User Story 1 - グループを作成して出欠を登録する (Priority: P1)

ユーザーがイベントやミーティングのためにグループを作成し、自分の出欠状況を登録できる。これがアプリの最も基本的な機能で、これだけで最小限の価値を提供できる。

**Why this priority**: アプリのコア機能。グループ作成と出欠登録ができなければ、このアプリの存在意義がない。最小限のMVP（Minimum Viable Product）として、この機能だけで出欠管理の基本的な価値を提供できる。

**Independent Test**: ユーザーがグループを作成し、自分の名前と出欠状況（◯/△/✗）を登録できることを確認する。データがローカルストレージに保存され、ページをリロードしても保持されることを検証する。

**Acceptance Scenarios**:

1. **Given** アプリのトップページを開いた状態で、**When** ユーザーが「新しいグループを作成」をクリックし、グループ名「12月の忘年会」と説明「12月20日開催」を入力して保存する、**Then** グループ一覧に「12月の忘年会」が表示される
2. **Given** グループ一覧が表示されている状態で、**When** ユーザーが「12月の忘年会」を選択し、名前「田中太郎」を入力して出欠状況「◯」を選択して登録する、**Then** 「登録しました」というメッセージが表示され、グループの出欠一覧に「田中太郎 - ◯」が表示される
3. **Given** 出欠を登録済みの状態で、**When** ページをリロードする、**Then** 登録したグループと出欠情報が保持されている

---

### User Story 2 - グループの集計結果を確認する (Priority: P2)

グループの管理者（この場合は全員）が、そのグループの出欠状況を集計した結果を確認できる。誰が参加予定か、合計何人が参加するかを一目で把握できる。

**Why this priority**: 出欠登録だけでは価値が限定的。集計結果を確認できることで、イベントの規模や参加者の傾向を把握でき、実用的な価値が大きく向上する。

**Independent Test**: 複数のユーザーが出欠を登録した後、グループの集計画面で「◯」「△」「✗」それぞれの人数が正しく表示されることを確認する。

**Acceptance Scenarios**:

1. **Given** 「12月の忘年会」グループに田中太郎（◯）、佐藤花子（△）、鈴木一郎（✗）、高橋美咲（◯）が登録されている状態で、**When** ユーザーが集計画面を開く、**Then** 「◯: 2人」「△: 1人」「✗: 1人」「合計: 4人」と表示される
2. **Given** 集計画面が表示されている状態で、**When** 新しいユーザーが出欠を追加する、**Then** 集計結果がリアルタイムに更新される（または画面をリロードすると最新の集計が表示される）

---

### User Story 3 - 登録内容を確認・編集する (Priority: P3)

ユーザーが自分の登録した出欠状況を後から確認し、変更や削除ができる。予定が変わった場合に柔軟に対応できる。

**Why this priority**: 実用性を高める機能だが、MVPとしては必須ではない。出欠の登録と集計ができれば基本的な価値は提供できるが、ユーザー体験を向上させるために追加する。

**Independent Test**: ユーザーが自分の登録を一覧で確認し、出欠状況を「◯」から「△」に変更できること、または登録を削除できることを確認する。

**Acceptance Scenarios**:

1. **Given** 田中太郎が「12月の忘年会」に「◯」で登録済みの状態で、**When** 田中太郎が自分の登録一覧を開き、「12月の忘年会」の出欠を「△」に変更する、**Then** 出欠状況が「△」に更新され、集計結果も「◯: 1人」「△: 2人」と更新される
2. **Given** 田中太郎が「12月の忘年会」に登録済みの状態で、**When** 田中太郎が自分の登録を削除する、**Then** 登録一覧から「12月の忘年会」の項目が削除され、集計結果から田中太郎の出欠が除外される

---

### User Story 4 - グループの出欠履歴を表示する (Priority: P3)

グループの詳細画面で、誰がいつ何を登録したかの履歴を時系列で確認できる。参加者の動向を把握できる。

**Why this priority**: ユーザー体験を向上させる補助的な機能。基本的な出欠管理には必須ではないが、あると便利。

**Independent Test**: グループの詳細画面で、登録者の名前、出欠状況、登録日時が時系列で表示されることを確認する。

**Acceptance Scenarios**:

1. **Given** 「12月の忘年会」グループに複数のユーザーが異なる時間に出欠を登録している状態で、**When** ユーザーがグループの履歴画面を開く、**Then** 「11/5 10:00 田中太郎 - ◯」「11/5 11:30 佐藤花子 - △」のように登録順に表示される

---

### Edge Cases

- **グループ名が空の場合**: グループ作成時にグループ名が入力されていない場合、「グループ名を入力してください」とエラーメッセージを表示する
- **名前が空の場合**: 出欠登録時に名前が入力されていない場合、「名前を入力してください」とエラーメッセージを表示する
- **出欠状況が選択されていない場合**: 出欠登録時に◯/△/✗のいずれも選択されていない場合、「出欠状況を選択してください」とエラーメッセージを表示する
- **重複登録の扱い**: 同じ名前で同じグループに複数回登録できる仕様とする（プロトタイプなので厳密な重複チェックは行わない）
- **ローカルストレージの容量制限**: ブラウザのローカルストレージの容量制限（通常5-10MB）を超える場合、「データの保存に失敗しました」とエラーメッセージを表示する
- **データの破損**: ローカルストレージのデータが破損している場合、初期状態にリセットし、「データを初期化しました」と通知する

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: システムは誰でもグループを作成できる機能を提供しなければならない（認証なし、全員が管理者）
- **FR-002**: システムはグループ作成時にグループ名（必須）と説明（任意）を入力できなければならない
- **FR-003**: システムは作成されたグループの一覧を表示しなければならない
- **FR-004**: システムはユーザーがグループを選択できなければならない
- **FR-005**: システムは出欠登録時にユーザーが名前を入力できなければならない
- **FR-006**: システムは出欠状況として「◯」（出席）、「△」（未定）、「✗」（欠席）の3つの選択肢を提供しなければならない
- **FR-007**: システムは入力された名前と出欠状況をローカルストレージに保存しなければならない
- **FR-008**: システムはグループごとに「◯」「△」「✗」それぞれの人数を集計して表示しなければならない
- **FR-009**: システムはグループごとの出欠登録者一覧を表示しなければならない（名前と出欠状況）
- **FR-010**: システムはユーザーが自分の登録を編集できなければならない（出欠状況の変更）
- **FR-011**: システムはユーザーが自分の登録を削除できなければならない
- **FR-012**: システムはグループの出欠履歴を時系列で表示しなければならない（登録者名、出欠状況、登録日時）
- **FR-013**: システムはページをリロードしてもデータが保持される必要がある（ローカルストレージの永続化）
- **FR-014**: システムは日本語で表示され、日本語の入力をサポートしなければならない
- **FR-015**: システムは入力バリデーションを行い、必須項目が未入力の場合はエラーメッセージを表示しなければならない

### Key Entities

- **グループ (Group)**: イベントやミーティングを表すエンティティ。グループ名、説明、作成日時を持つ。複数の出欠登録を含む。
- **出欠登録 (Attendance)**: ユーザーの出欠状況を表すエンティティ。登録者名、出欠状況（◯/△/✗）、登録日時、所属グループを持つ。
- **集計結果 (Summary)**: グループごとの集計データを表す。◯の人数、△の人数、✗の人数、合計人数を含む。グループエンティティから動的に算出される。

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: ユーザーはグループ作成から出欠登録まで1分以内に完了できる
- **SC-002**: システムは100件のグループと各グループに50件の出欠登録があっても、ページの表示とデータの読み込みが3秒以内に完了する
- **SC-003**: ユーザーの90%以上が、説明なしで直感的にグループを作成し出欠を登録できる
- **SC-004**: 集計結果は常に最新の出欠状況を反映し、データの不整合が発生しない
- **SC-005**: ページをリロードしても、登録したデータが100%保持される
- **SC-006**: モバイル端末（320px幅）からデスクトップ（1920px幅）まで、すべてのデバイスで快適に操作できる
- **SC-007**: 入力エラー発生時、ユーザーは明確なエラーメッセージにより何を修正すべきか即座に理解できる

## Assumptions

- プロトタイプのため、認証機能は実装しない（将来的にはSupabase Authで実装予定）
- データはブラウザのローカルストレージに保存する（将来的にはSupabaseデータベースに移行予定）
- 同じ名前での重複登録を許可する（認証がないため、ユーザーの識別ができない）
- グループの削除機能はプロトタイプでは実装しない
- 通知機能（出欠登録時の通知など）はプロトタイプでは実装しない
- ローカルストレージの容量は十分にあると仮定する（通常5-10MBで、このプロトタイプの用途では十分）
- 日本語のみをサポートし、多言語対応は将来的な拡張とする

## Out of Scope

以下の機能はこのプロトタイプの範囲外とし、将来のイテレーションで実装する：

- ユーザー認証とログイン機能
- グループの削除機能
- 出欠登録の締切設定
- 通知機能（メール、プッシュ通知）
- CSVエクスポート機能
- データのクラウド同期（Supabaseへの移行）
- 管理者と一般ユーザーの権限分離
- グループへの招待機能
- コメント・メモ機能
