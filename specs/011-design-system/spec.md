# Feature Specification: デザインシステム改善

**Feature Branch**: `011-design-system`
**Created**: 2025-11-19
**Status**: Draft
**Input**: User description: "デザインシステム改善：共通UIコンポーネント化（Button/Input/Card/Message/Heading）、全11ページのUI統一、使い方ガイド更新（UIページ2つ+README+quickstart10個）、ダークモード完全対応、アクセシビリティ改善（WCAG 2.1 AA準拠）"

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 一貫したUI操作体験 (Priority: P1)

ユーザーとして、アプリケーション全体で一貫したボタンやフォームのデザインを使用したい。これにより、画面間の移動時に操作方法を再学習する必要がなくなり、直感的に操作できる。

**Why this priority**: UIの一貫性はユーザビリティの根幹であり、全ての改善の土台となる。ボタンの色・サイズ・スタイルが統一されることで、ユーザーは操作に迷わなくなる。

**Independent Test**: 任意のページでボタンをクリックし、期待通りの視覚的フィードバック（ホバー、フォーカス）が得られることを確認。全ページで同じパターンが適用されていることを目視確認。

**Acceptance Scenarios**:

1. **Given** ユーザーがグループ管理画面にいる, **When** 削除ボタンにホバーする, **Then** 赤色の警告スタイル（背景色変化）が表示される
2. **Given** ユーザーがイベント登録画面にいる, **When** 登録ボタンをクリックする, **Then** 青色のプライマリボタンスタイルと同じ視覚的フィードバックが得られる
3. **Given** ユーザーが任意のフォームを入力中, **When** 入力欄にフォーカスする, **Then** 青色のフォーカスリングが表示される

---

### User Story 2 - ダークモードでの快適な閲覧 (Priority: P2)

ユーザーとして、暗い環境でもアプリケーションを快適に使用したい。システム設定に応じてダークモードが自動的に適用され、目の疲れを軽減できる。

**Why this priority**: ダークモード対応は現代のウェブアプリケーションでは標準的な機能であり、ユーザー体験を大きく向上させる。ただし、基本的なUI統一が前提となるためP2。

**Independent Test**: ブラウザまたはOSの設定をダークモードに変更し、全ての要素（背景、テキスト、ボタン、カード）が適切なダークカラーで表示されることを確認。

**Acceptance Scenarios**:

1. **Given** システム設定がダークモードの状態, **When** アプリケーションを開く, **Then** 暗い背景色と明るいテキスト色で表示される
2. **Given** ダークモードで表示中, **When** ボタンにホバーする, **Then** ダークモード用の適切なホバー色が適用される
3. **Given** ダークモードで表示中, **When** エラーメッセージが表示される, **Then** 赤色が暗い背景でも視認できる明度で表示される

---

### User Story 3 - スクリーンリーダーでの操作 (Priority: P3)

視覚障害のあるユーザーとして、スクリーンリーダーを使用してアプリケーションを操作したい。全ての要素が適切にラベル付けされ、状態変化が通知される。

**Why this priority**: アクセシビリティはインクルーシブなアプリケーションに必須だが、視覚的なUI統一とダークモード対応の後に実装することで効率的に進められる。

**Independent Test**: VoiceOverまたはNVDAでアプリケーションを操作し、全ての入力欄・ボタンが適切に読み上げられることを確認。

**Acceptance Scenarios**:

1. **Given** スクリーンリーダーを使用中, **When** 入力欄にフォーカスする, **Then** 入力欄の目的（例：「団体名入力欄」）が読み上げられる
2. **Given** スクリーンリーダーを使用中, **When** エラーメッセージが表示される, **Then** 即座に「エラー：[メッセージ内容]」が通知される
3. **Given** スクリーンリーダーを使用中, **When** アコーディオンを展開/折りたたむ, **Then** 現在の展開状態が読み上げられる

---

### User Story 4 - 明確な情報階層の把握 (Priority: P4)

ユーザーとして、ページ内の情報階層を視覚的に把握したい。見出しのサイズやセクションの区切りが一貫していることで、必要な情報を素早く見つけられる。

**Why this priority**: 情報階層の明確化はユーザビリティ向上に貢献するが、基本的なコンポーネント統一の後に実施することで効果的。

**Independent Test**: 任意のページで見出し（h1/h2/h3）のサイズが統一されていることを確認。セクション間のスペーシングが一貫していることを目視確認。

**Acceptance Scenarios**:

1. **Given** 任意のページを表示中, **When** ページタイトル（h1）を確認する, **Then** 全ページで同じフォントサイズ（大/太字）が適用されている
2. **Given** 管理画面を表示中, **When** セクション見出し（h2）を確認する, **Then** 全セクションで同じフォントサイズ（中/太字）が適用されている

---

### User Story 5 - 最新ドキュメントの参照 (Priority: P5)

ユーザー・開発者として、UIの変更に合わせて更新されたドキュメントを参照したい。使い方ガイドやREADMEが最新のUIを反映している。

**Why this priority**: ドキュメント更新はUIの実装完了後に行う必要があるため、最後の優先度となる。

**Independent Test**: README.mdと使い方ガイドページを確認し、新しいUIコンポーネントや操作方法が正確に記載されていることを確認。

**Acceptance Scenarios**:

1. **Given** README.mdを参照する, **When** 機能一覧を確認する, **Then** 新しいデザインシステムについての説明が含まれている
2. **Given** 使い方ガイドページを表示する, **When** 操作説明を確認する, **Then** 新しいボタンスタイルに対応した説明が表示される

---

### Edge Cases

- ボタンが無効（disabled）状態の場合、適切なグレーアウト表示がされるか？
- 非常に長いテキストがボタンやカードに入力された場合、レイアウトが崩れないか？
- 極端に小さい画面（320px幅）でもUIが使用可能か？
- ダークモードとライトモードを切り替えた際、即座に反映されるか？
- JavaScriptが無効な環境でも基本的なスタイリングが適用されるか？

## Requirements *(mandatory)*

### Functional Requirements

#### 共通コンポーネント

- **FR-001**: システムはButtonコンポーネントを提供し、4つのバリアント（primary/secondary/danger/ghost）と3つのサイズ（sm/md/lg）をサポートする
- **FR-002**: システムはInputコンポーネントを提供し、text-gray-900とplaceholder:text-gray-400のスタイルを標準で適用する
- **FR-003**: システムはCardコンポーネントを提供し、ホバー時のシャドウトランジションを統一する
- **FR-004**: システムはMessageコンポーネントを提供し、4つのタイプ（error/success/warning/info）をサポートし、各タイプに適切なアイコンを表示する
- **FR-005**: システムはHeadingコンポーネントを提供し、h1/h2/h3のサイズを統一する

#### UI統一

- **FR-006**: 全ての削除ボタンはdangerバリアントを使用し、赤色系の背景色またはアウトラインを表示する
- **FR-007**: 全ての編集ボタンはsecondaryバリアントを使用し、グレー系のスタイルを表示する
- **FR-008**: 全てのページで見出しサイズが統一される（h1: text-3xl sm:text-4xl、h2: text-xl sm:text-2xl、h3: text-lg）
- **FR-009**: セクション間のマージンは`mb-6 sm:mb-8`に統一される

#### ダークモード

- **FR-010**: 全ての共通コンポーネントはdark:プレフィックスを使用したダークモードスタイルを持つ
- **FR-011**: システム設定（prefers-color-scheme: dark）に応じて自動的にダークモードが適用される

#### アクセシビリティ

- **FR-012**: 全ての入力要素（input/select/textarea）にaria-labelまたはaria-labelledbyが設定される
- **FR-013**: 全てのエラー/成功メッセージにrole="alert"が設定される
- **FR-014**: 全てのボタン・入力要素にフォーカス表示（focus:ring-2 focus:ring-blue-500）が適用される
- **FR-015**: テキストと背景のコントラスト比はWCAG 2.1 AAレベル（4.5:1以上）を満たす

#### ドキュメント更新

- **FR-016**: README.mdに新しいデザインシステムの概要を追加する
- **FR-017**: 使い方ガイドページ（app/guide, app/[org]/guide）を新しいコンポーネントで更新する
- **FR-018**: 全てのquickstart.md（10ファイル）のUI説明を最新の状態に更新する

### Key Entities

- **UIComponent**: 再利用可能なUIコンポーネント（Button, Input, Card, Message, Heading）。各コンポーネントはprops経由でバリアントやサイズを受け取る
- **Theme**: ライトモード/ダークモードの色定義。CSS変数とTailwindのdark:プレフィックスで管理
- **Page**: アプリケーションの各ページ（11ページ）。共通コンポーネントをインポートして使用

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 全11ページでボタン・入力・カード・メッセージ・見出しのスタイルが統一されている（目視確認で100%一致）
- **SC-002**: ダークモード設定時、全ての要素が適切な暗色系カラーで表示される（未対応要素0件）
- **SC-003**: 全ての入力要素にaria-labelが設定されている（アクセシビリティ監査で警告0件）
- **SC-004**: 全てのエラー/成功メッセージにアイコンが表示され、role="alert"が設定されている
- **SC-005**: 320px〜1440pxの全てのブレークポイントでレイアウトが崩れない
- **SC-006**: 既存の485テストが全てパスする
- **SC-007**: ビルドが成功する
- **SC-008**: README.mdと使い方ガイドが新しいUIを正確に反映している

## Assumptions

- 既存のTailwind CSS 3.4の設定を継続使用する
- ダークモードはシステム設定（prefers-color-scheme）に自動追従する（手動切り替えは将来対応）
- スクリーンショットの更新は本フィーチャーのスコープ外とする（必要に応じて別途対応）
- パフォーマンスへの影響は最小限（共通コンポーネント化によるバンドルサイズ増加は許容範囲内）
